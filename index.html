<!DOCTYPE html>
<html>
<head>
    <title>Redirecting...</title>
    <script>
        function getCookie(name) {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                const [key, value] = cookie.trim().split('=');
                if (key === name) return decodeURIComponent(value);
            }
            return null;
        }

        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        function redirect() {
            const preferredVersion = getCookie('preferred_version');
            const isMobileDevice = isMobile();
            const screenWidth = window.innerWidth;

            if (preferredVersion) {
                window.location.href = `/${preferredVersion}/index.html`;
            } else if (isMobileDevice) {
                window.location.href = '/m/index.html';
            } else {
                window.location.href = '/d/index.html';
            }
        }

        redirect();
    </script>
</head>
<body>
    <noscript>
        <h2>请启用JavaScript以获取最佳体验</h2>
        <p>
            <a href="/d/index.html">访问桌面版</a> |
            <a href="/m/index.html">访问移动版</a>
        </p>
    </noscript>
</body>
</html>